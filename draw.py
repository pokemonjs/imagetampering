import matplotlib.pyplot as plt
import numpy as np

loss_records = ['''epoch 1 loss:0.2829531729221344
epoch 2 loss:0.17318832874298096
epoch 3 loss:0.11950735747814178
epoch 4 loss:0.08947361260652542
epoch 5 loss:0.0692829117178917
epoch 6 loss:0.05707000195980072
epoch 7 loss:0.050112150609493256
epoch 8 loss:0.04431334510445595
epoch 9 loss:0.03852128982543945
epoch 10 loss:0.03563493490219116
epoch 11 loss:0.03139030933380127
epoch 12 loss:0.030224159359931946
epoch 13 loss:0.027991967275738716
epoch 14 loss:0.02514016255736351
epoch 15 loss:0.024564096704125404
epoch 16 loss:0.022187335416674614
epoch 17 loss:0.023760972544550896
epoch 18 loss:0.02113594487309456
epoch 19 loss:0.019329553470015526
epoch 20 loss:0.020591149106621742
epoch 21 loss:0.01933429017663002
epoch 22 loss:0.017870381474494934
epoch 23 loss:0.01727672852575779
epoch 24 loss:0.01658814214169979
epoch 25 loss:0.01629808358848095
epoch 26 loss:0.0148697504773736
epoch 27 loss:0.014398365281522274
epoch 28 loss:0.016127070412039757
epoch 29 loss:0.013947363011538982
epoch 30 loss:0.015620353631675243
epoch 31 loss:0.01422884501516819
epoch 32 loss:0.012589584104716778
epoch 33 loss:0.01299256645143032
epoch 34 loss:0.013713713735342026
epoch 35 loss:0.012898391112685204
epoch 36 loss:0.012736386619508266
epoch 37 loss:0.011068911291658878
epoch 38 loss:0.012333798222243786
epoch 39 loss:0.011883845552802086
epoch 40 loss:0.011652201414108276
epoch 41 loss:0.010073645040392876
epoch 42 loss:0.010719534941017628
epoch 43 loss:0.01050402969121933
epoch 44 loss:0.009505923837423325
epoch 45 loss:0.013124740682542324
epoch 46 loss:0.009239329025149345
epoch 47 loss:0.010727545246481895
epoch 48 loss:0.009937961585819721
epoch 49 loss:0.00925859622657299
epoch 50 loss:0.009426024742424488
epoch 51 loss:0.009761904366314411
epoch 52 loss:0.00969652272760868
epoch 53 loss:0.009541910141706467
epoch 54 loss:0.008203152567148209
epoch 55 loss:0.010377674363553524
epoch 56 loss:0.008218173868954182
epoch 57 loss:0.009095595218241215
epoch 58 loss:0.008288804441690445
epoch 59 loss:0.009612778201699257
epoch 60 loss:0.007415113504976034
epoch 61 loss:0.008390355855226517
epoch 62 loss:0.007460408378392458
epoch 63 loss:0.009239189326763153
epoch 64 loss:0.008337131701409817
epoch 65 loss:0.007390651851892471
epoch 66 loss:0.008631010539829731
epoch 67 loss:0.008152475580573082
epoch 68 loss:0.008588368073105812
epoch 69 loss:0.007321234792470932
epoch 70 loss:0.008224808610975742
epoch 71 loss:0.007890455424785614
epoch 72 loss:0.007181192748248577
epoch 73 loss:0.007488405331969261
epoch 74 loss:0.008129104971885681
epoch 75 loss:0.006715788971632719
epoch 76 loss:0.006950859911739826
epoch 77 loss:0.007298272103071213
epoch 78 loss:0.007757197599858046
epoch 79 loss:0.006173054687678814
epoch 80 loss:0.008404124528169632
epoch 81 loss:0.006800027098506689
epoch 82 loss:0.006387039087712765
epoch 83 loss:0.007258881349116564
epoch 84 loss:0.007232155650854111
epoch 85 loss:0.006855989806354046
epoch 86 loss:0.006161160301417112
epoch 87 loss:0.006889399141073227
epoch 88 loss:0.005997303873300552
epoch 89 loss:0.005672447849065065
epoch 90 loss:0.00768932094797492
epoch 91 loss:0.005611758679151535
epoch 92 loss:0.007279960438609123
epoch 93 loss:0.0063292416743934155
epoch 94 loss:0.005616090260446072
epoch 95 loss:0.005409322679042816
epoch 96 loss:0.006575031206011772
epoch 97 loss:0.0055760350078344345
epoch 98 loss:0.007579312194138765
epoch 99 loss:0.006534871179610491
epoch 100 loss:0.005166350398212671''',
           '''epoch 1 loss:0.2809882164001465
epoch 2 loss:0.17035669088363647
epoch 3 loss:0.1206708624958992
epoch 4 loss:0.08972430974245071
epoch 5 loss:0.07042461633682251
epoch 6 loss:0.06016086786985397
epoch 7 loss:0.04997047409415245
epoch 8 loss:0.04391886666417122
epoch 9 loss:0.03903433680534363
epoch 10 loss:0.03447062894701958
epoch 11 loss:0.0337609238922596
epoch 12 loss:0.02951030805706978
epoch 13 loss:0.028182558715343475
epoch 14 loss:0.02672700211405754
epoch 15 loss:0.022694233804941177
epoch 16 loss:0.023992983624339104
epoch 17 loss:0.02082573063671589
epoch 18 loss:0.023046251386404037
epoch 19 loss:0.019370844587683678
epoch 20 loss:0.021345114335417747
epoch 21 loss:0.017953136935830116
epoch 22 loss:0.016985053196549416
epoch 23 loss:0.01833188347518444
epoch 24 loss:0.017708048224449158
epoch 25 loss:0.015941966325044632
epoch 26 loss:0.016100674867630005
epoch 27 loss:0.015242661349475384
epoch 28 loss:0.01505393534898758
epoch 29 loss:0.013565290719270706
epoch 30 loss:0.014466938562691212
epoch 31 loss:0.013363953679800034
epoch 32 loss:0.013415398076176643
epoch 33 loss:0.012592815794050694
epoch 34 loss:0.011963705532252789
epoch 35 loss:0.013589533045887947
epoch 36 loss:0.010161983780562878
epoch 37 loss:0.013362768106162548
epoch 38 loss:0.011284975335001945
epoch 39 loss:0.01201220415532589
epoch 40 loss:0.009839356876909733
epoch 41 loss:0.010794702917337418
epoch 42 loss:0.010282352566719055
epoch 43 loss:0.010185650549829006
epoch 44 loss:0.01139388419687748
epoch 45 loss:0.00942920334637165
epoch 46 loss:0.0122705502435565
epoch 47 loss:0.009704960510134697
epoch 48 loss:0.009911846369504929
epoch 49 loss:0.011385519057512283
epoch 50 loss:0.009015047922730446''',
'''

epoch 1 loss:0.2816063165664673
epoch 2 loss:0.1716403365135193
epoch 3 loss:0.11876820027828217
epoch 4 loss:0.08989783376455307
epoch 5 loss:0.07036039978265762
epoch 6 loss:0.05850859358906746
epoch 7 loss:0.04896573722362518
epoch 8 loss:0.04326049983501434
epoch 9 loss:0.03782276809215546
epoch 10 loss:0.036707308143377304
epoch 11 loss:0.03235425800085068
epoch 12 loss:0.029881682246923447
epoch 13 loss:0.028230080381035805
epoch 14 loss:0.025794779881834984
epoch 15 loss:0.024461256340146065
epoch 16 loss:0.022492051124572754
epoch 17 loss:0.02362626977264881
epoch 18 loss:0.02146238274872303
epoch 19 loss:0.02019052393734455
epoch 20 loss:0.020608101040124893
epoch 21 loss:0.018629997968673706
epoch 22 loss:0.01826690509915352
epoch 23 loss:0.018389703705906868
epoch 24 loss:0.01757959835231304
epoch 25 loss:0.015450230799615383
epoch 26 loss:0.015835963189601898
epoch 27 loss:0.015902401879429817
epoch 28 loss:0.01598416082561016
epoch 29 loss:0.013458650559186935
epoch 30 loss:0.014145100489258766
'''
]

f1_records=[
'''
epoch 1 f1:0.6436612161763291
epoch 2 f1:0.7054298060700049
epoch 3 f1:0.7219735454029051
epoch 4 f1:0.7219785709419897
epoch 5 f1:0.7298624983420219
epoch 6 f1:0.7146161834430443
epoch 7 f1:0.7194698871683906
epoch 8 f1:0.7264903962817091
epoch 9 f1:0.7156914037653999
epoch 10 f1:0.710084617937793
epoch 11 f1:0.724562160296782
epoch 12 f1:0.7186852568194227
epoch 13 f1:0.7254464303214331
epoch 14 f1:0.71120300601539
epoch 15 f1:0.721697517263906
epoch 16 f1:0.7238225064051733
epoch 17 f1:0.7087159538347892
epoch 18 f1:0.7198806795909197
epoch 19 f1:0.7173805067470228
epoch 20 f1:0.7174842601588529
epoch 21 f1:0.7087179784822731
epoch 22 f1:0.7210446968758654
epoch 23 f1:0.7111181699239575
epoch 24 f1:0.7105143829367905
epoch 25 f1:0.7222781606185755
epoch 26 f1:0.7095165197111665
epoch 27 f1:0.7227072479404152
epoch 28 f1:0.7244699018186389
epoch 29 f1:0.7204893023868065
epoch 30 f1:0.72390059153549''',
    '''
epoch 1 f1:0.6408976877151358
epoch 2 f1:0.7030449588495394
epoch 3 f1:0.7069494031229425
epoch 4 f1:0.7147807090515839
epoch 5 f1:0.7119183544471335
epoch 6 f1:0.710559000314854
epoch 7 f1:0.7057387151203709
epoch 8 f1:0.7120114187986244
epoch 9 f1:0.7008057815013303
epoch 10 f1:0.7119237997152066
epoch 11 f1:0.7144518639971407
epoch 12 f1:0.7050077234942304
epoch 13 f1:0.7114818641048376
epoch 14 f1:0.7117890633054645
epoch 15 f1:0.7101460026832925
epoch 16 f1:0.7168100050485816
epoch 17 f1:0.7059863342774654
epoch 18 f1:0.7031548515407168
epoch 19 f1:0.7126076730203422
epoch 20 f1:0.7138626536949133
epoch 21 f1:0.7233529567064256
epoch 22 f1:0.745927917371765
epoch 23 f1:0.7254487986955279
epoch 24 f1:0.7337852196651794
epoch 25 f1:0.7303594731735743
epoch 26 f1:0.7329818122839433
epoch 27 f1:0.7268408773842602
epoch 28 f1:0.73696325270102
epoch 29 f1:0.7266301300882556
epoch 30 f1:0.7268020296481572''',
    '''epoch 1 f1:0.6352274194955341
epoch 2 f1:0.6975782684256128
epoch 3 f1:0.700291578197892
epoch 4 f1:0.7166187560890536
epoch 5 f1:0.7197685966788555
epoch 6 f1:0.7165332069871526
epoch 7 f1:0.7204253759294916
epoch 8 f1:0.7228007124480506
epoch 9 f1:0.7302086529005333
epoch 10 f1:0.7219986181980326
epoch 11 f1:0.7221982455624106
epoch 12 f1:0.7213628546530011
epoch 13 f1:0.7149754515389447
epoch 14 f1:0.7278926421471571
epoch 15 f1:0.7125138101917977
epoch 16 f1:0.7114922115557335
epoch 17 f1:0.7218402304147821
epoch 18 f1:0.7285082905656541
epoch 19 f1:0.7228073473809603
epoch 20 f1:0.7289158840933816
epoch 21 f1:0.7221744415962612
epoch 22 f1:0.7372470700540698
epoch 23 f1:0.7117405667458683
epoch 24 f1:0.7092288711816926
epoch 25 f1:0.7127408851933698
epoch 26 f1:0.712154772428138
epoch 27 f1:0.7126716285243035
epoch 28 f1:0.7151271787798036
epoch 29 f1:0.7151993551525972
epoch 30 f1:0.7123644807886828'''
]
models=["unet","res_unet","se_runet","se_att_runet","ca_att_runet","ca_se_att_runet",
        "rrunet","se_att_rrunet","ca_att_rrunet","ca_se_att_rrunet"]
models=["100epoch","50epoch","30epoch"]


'''
100ep
finetune:final.ca_se_att_rrunet.san.pdparams
auc:0.7869639387531927
precision:0.34502752187543645
recall:0.32417439882237964
f1:0.3342760563643136
'''

def draw(record,model):
    x = []
    f1 = []
    records = record.strip().split("\n")
    for ind in range(len(records)):
        rec = records[ind].strip()
        x.append(ind + 1)
        f1.append(float(rec.split(":")[-1]))
    plt.plot(x, f1, label=model)

records = f1_records
for ind in range(len(records)):
    rec=records[ind]
    draw(rec,models[ind])
plt.legend()
plt.show()
